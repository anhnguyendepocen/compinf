{
    "collab_server" : "",
    "contents" : "library(ProjectTemplate)\nload.project()\n\n#initial estimates of mean from visual inspection of histogram\nmu <- c(-3, 2, 5) # the mean\nphi <- c(1/3,1/3,1/3) # the weight of each distribution\nemResults <- em(mixture_normal,mu,phi)\n\n#plot the histogram with density function and parameter estimates\nhist(mixture_normal, freq=FALSE, main=\"\", xlab=\"mixturenormal values\")\n#histograms suggest that there are 3 normal distributions centered approx. on -4, 2, 6\n\nlines(smooth.spline(mixture_normal, emResults$densityAl, spar=0.35), col=\"blue\", lwd=2)\nabline(v=emResults$mu, lty=\"dotted\", col=\"red\")\n\n#run multiple times using random initial values to test sensitivity and look at convergence times\n#TODO: parallelise for speed\nn <- 1000\nresults <- matrix(nrow=n, ncol=13,byrow=T)\ncolnames(results) <- c(\"initial mu1\", \"initial mu2\", \"initial mu3\", \"initial phi1\", \"initial phi2\", \"initial phi3\",\"mu1\", \"mu2\", \"mu3\", \"phi1\", \"phi2\", \"phi3\", \"iterations\")\nfor (m in 1:n) {\n  res <- em(mixture_normal,\n            mu=runif(3, min(mixture_normal), max(mixture_normal)), \n            phi=runif(3))\n  results[m,1:3] <- (res$initialMu)\n  results[m,4:6] <- (res$initialPhi)\n  results[m,7:9] <- (res$mu)\n  results[m,10:12] <- (res$phi)\n  results[m,13] <- res$iterations\n  message(\"m = \", m)\n}\n\nresults <- data.frame(results)\nhist(results$iterations)\n",
    "created" : 1483194804844.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3782531592",
    "id" : "2A707F63",
    "lastKnownWriteTime" : 1483194828,
    "last_content_update" : 1483194828953,
    "path" : "D:/projects/compinf/src/expectation_maximisation.R",
    "project_path" : "src/expectation_maximisation.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}